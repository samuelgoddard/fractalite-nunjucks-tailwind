{"id":"Di21","dependencies":[{"name":"/Users/Sam/code/fractalite/packages/fractalite/package.json","includedInParent":true,"mtime":1551782427000},{"name":"/Users/Sam/code/fractalite/packages/fractalite/.babelrc","includedInParent":true,"mtime":1551782427000},{"name":"/Users/Sam/code/fractalite/packages/fractalite/node_modules/socket.io-client/package.json","includedInParent":true,"mtime":1551785040000},{"name":"engine.io-client","loc":{"line":6,"column":18},"parent":"/Users/Sam/code/fractalite/packages/fractalite/node_modules/socket.io-client/lib/manager.js","resolved":"/Users/Sam/code/fractalite/packages/fractalite/node_modules/engine.io-client/lib/index.js"},{"name":"./socket","loc":{"line":7,"column":21},"parent":"/Users/Sam/code/fractalite/packages/fractalite/node_modules/socket.io-client/lib/manager.js","resolved":"/Users/Sam/code/fractalite/packages/fractalite/node_modules/socket.io-client/lib/socket.js"},{"name":"component-emitter","loc":{"line":8,"column":22},"parent":"/Users/Sam/code/fractalite/packages/fractalite/node_modules/socket.io-client/lib/manager.js","resolved":"/Users/Sam/code/fractalite/packages/fractalite/node_modules/component-emitter/index.js"},{"name":"socket.io-parser","loc":{"line":9,"column":21},"parent":"/Users/Sam/code/fractalite/packages/fractalite/node_modules/socket.io-client/lib/manager.js","resolved":"/Users/Sam/code/fractalite/packages/fractalite/node_modules/socket.io-parser/index.js"},{"name":"./on","loc":{"line":10,"column":17},"parent":"/Users/Sam/code/fractalite/packages/fractalite/node_modules/socket.io-client/lib/manager.js","resolved":"/Users/Sam/code/fractalite/packages/fractalite/node_modules/socket.io-client/lib/on.js"},{"name":"component-bind","loc":{"line":11,"column":19},"parent":"/Users/Sam/code/fractalite/packages/fractalite/node_modules/socket.io-client/lib/manager.js","resolved":"/Users/Sam/code/fractalite/packages/fractalite/node_modules/component-bind/index.js"},{"name":"debug","loc":{"line":12,"column":20},"parent":"/Users/Sam/code/fractalite/packages/fractalite/node_modules/socket.io-client/lib/manager.js","resolved":"/Users/Sam/code/fractalite/packages/fractalite/node_modules/socket.io-client/node_modules/debug/src/browser.js"},{"name":"indexof","loc":{"line":13,"column":22},"parent":"/Users/Sam/code/fractalite/packages/fractalite/node_modules/socket.io-client/lib/manager.js","resolved":"/Users/Sam/code/fractalite/packages/fractalite/node_modules/indexof/index.js"},{"name":"backo2","loc":{"line":14,"column":22},"parent":"/Users/Sam/code/fractalite/packages/fractalite/node_modules/socket.io-client/lib/manager.js","resolved":"/Users/Sam/code/fractalite/packages/fractalite/node_modules/backo2/index.js"}],"generated":{"js":"var t=require(\"engine.io-client\"),e=require(\"./socket\"),n=require(\"component-emitter\"),o=require(\"socket.io-parser\"),i=require(\"./on\"),s=require(\"component-bind\"),c=require(\"debug\")(\"socket.io-client:manager\"),r=require(\"indexof\"),h=require(\"backo2\"),a=Object.prototype.hasOwnProperty;function p(t,e){if(!(this instanceof p))return new p(t,e);t&&\"object\"==typeof t&&(e=t,t=void 0),(e=e||{}).path=e.path||\"/socket.io\",this.nsps={},this.subs=[],this.opts=e,this.reconnection(!1!==e.reconnection),this.reconnectionAttempts(e.reconnectionAttempts||1/0),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor(e.randomizationFactor||.5),this.backoff=new h({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==e.timeout?2e4:e.timeout),this.readyState=\"closed\",this.uri=t,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[];var n=e.parser||o;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this.autoConnect=!1!==e.autoConnect,this.autoConnect&&this.open()}module.exports=p,p.prototype.emitAll=function(){for(var t in this.emit.apply(this,arguments),this.nsps)a.call(this.nsps,t)&&this.nsps[t].emit.apply(this.nsps[t],arguments)},p.prototype.updateSocketIds=function(){for(var t in this.nsps)a.call(this.nsps,t)&&(this.nsps[t].id=this.generateId(t))},p.prototype.generateId=function(t){return(\"/\"===t?\"\":t+\"#\")+this.engine.id},n(p.prototype),p.prototype.reconnection=function(t){return arguments.length?(this._reconnection=!!t,this):this._reconnection},p.prototype.reconnectionAttempts=function(t){return arguments.length?(this._reconnectionAttempts=t,this):this._reconnectionAttempts},p.prototype.reconnectionDelay=function(t){return arguments.length?(this._reconnectionDelay=t,this.backoff&&this.backoff.setMin(t),this):this._reconnectionDelay},p.prototype.randomizationFactor=function(t){return arguments.length?(this._randomizationFactor=t,this.backoff&&this.backoff.setJitter(t),this):this._randomizationFactor},p.prototype.reconnectionDelayMax=function(t){return arguments.length?(this._reconnectionDelayMax=t,this.backoff&&this.backoff.setMax(t),this):this._reconnectionDelayMax},p.prototype.timeout=function(t){return arguments.length?(this._timeout=t,this):this._timeout},p.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},p.prototype.open=p.prototype.connect=function(e,n){if(c(\"readyState %s\",this.readyState),~this.readyState.indexOf(\"open\"))return this;c(\"opening %s\",this.uri),this.engine=t(this.uri,this.opts);var o=this.engine,s=this;this.readyState=\"opening\",this.skipReconnect=!1;var r=i(o,\"open\",function(){s.onopen(),e&&e()}),h=i(o,\"error\",function(t){if(c(\"connect_error\"),s.cleanup(),s.readyState=\"closed\",s.emitAll(\"connect_error\",t),e){var n=new Error(\"Connection error\");n.data=t,e(n)}else s.maybeReconnectOnOpen()});if(!1!==this._timeout){var a=this._timeout;c(\"connect attempt will timeout after %d\",a);var p=setTimeout(function(){c(\"connect attempt timed out after %d\",a),r.destroy(),o.close(),o.emit(\"error\",\"timeout\"),s.emitAll(\"connect_timeout\",a)},a);this.subs.push({destroy:function(){clearTimeout(p)}})}return this.subs.push(r),this.subs.push(h),this},p.prototype.onopen=function(){c(\"open\"),this.cleanup(),this.readyState=\"open\",this.emit(\"open\");var t=this.engine;this.subs.push(i(t,\"data\",s(this,\"ondata\"))),this.subs.push(i(t,\"ping\",s(this,\"onping\"))),this.subs.push(i(t,\"pong\",s(this,\"onpong\"))),this.subs.push(i(t,\"error\",s(this,\"onerror\"))),this.subs.push(i(t,\"close\",s(this,\"onclose\"))),this.subs.push(i(this.decoder,\"decoded\",s(this,\"ondecoded\")))},p.prototype.onping=function(){this.lastPing=new Date,this.emitAll(\"ping\")},p.prototype.onpong=function(){this.emitAll(\"pong\",new Date-this.lastPing)},p.prototype.ondata=function(t){this.decoder.add(t)},p.prototype.ondecoded=function(t){this.emit(\"packet\",t)},p.prototype.onerror=function(t){c(\"error\",t),this.emitAll(\"error\",t)},p.prototype.socket=function(t,n){var o=this.nsps[t];if(!o){o=new e(this,t,n),this.nsps[t]=o;var i=this;o.on(\"connecting\",s),o.on(\"connect\",function(){o.id=i.generateId(t)}),this.autoConnect&&s()}function s(){~r(i.connecting,o)||i.connecting.push(o)}return o},p.prototype.destroy=function(t){var e=r(this.connecting,t);~e&&this.connecting.splice(e,1),this.connecting.length||this.close()},p.prototype.packet=function(t){c(\"writing packet %j\",t);var e=this;t.query&&0===t.type&&(t.nsp+=\"?\"+t.query),e.encoding?e.packetBuffer.push(t):(e.encoding=!0,this.encoder.encode(t,function(n){for(var o=0;o<n.length;o++)e.engine.write(n[o],t.options);e.encoding=!1,e.processPacketQueue()}))},p.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var t=this.packetBuffer.shift();this.packet(t)}},p.prototype.cleanup=function(){c(\"cleanup\");for(var t=this.subs.length,e=0;e<t;e++){this.subs.shift().destroy()}this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},p.prototype.close=p.prototype.disconnect=function(){c(\"disconnect\"),this.skipReconnect=!0,this.reconnecting=!1,\"opening\"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState=\"closed\",this.engine&&this.engine.close()},p.prototype.onclose=function(t){c(\"onclose\"),this.cleanup(),this.backoff.reset(),this.readyState=\"closed\",this.emit(\"close\",t),this._reconnection&&!this.skipReconnect&&this.reconnect()},p.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var t=this;if(this.backoff.attempts>=this._reconnectionAttempts)c(\"reconnect failed\"),this.backoff.reset(),this.emitAll(\"reconnect_failed\"),this.reconnecting=!1;else{var e=this.backoff.duration();c(\"will wait %dms before reconnect attempt\",e),this.reconnecting=!0;var n=setTimeout(function(){t.skipReconnect||(c(\"attempting reconnect\"),t.emitAll(\"reconnect_attempt\",t.backoff.attempts),t.emitAll(\"reconnecting\",t.backoff.attempts),t.skipReconnect||t.open(function(e){e?(c(\"reconnect attempt error\"),t.reconnecting=!1,t.reconnect(),t.emitAll(\"reconnect_error\",e.data)):(c(\"reconnect success\"),t.onreconnect())}))},e);this.subs.push({destroy:function(){clearTimeout(n)}})}},p.prototype.onreconnect=function(){var t=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll(\"reconnect\",t)};","map":null},"hash":"c3ba0689cc66a0d25661be5de3cde0a3","cacheData":{"env":{}}}